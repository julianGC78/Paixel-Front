<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Perfil de Usuario</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }

    form {
      margin-bottom: 20px;
    }

    label {
      margin-right: 10px;
    }

    input,
    button {
      margin-top: 10px;
    }

    .response {
      margin-top: 20px;
      color: green;
    }

    .error {
      color: red;
    }
  </style>
</head>

<body>
  <h1>Administración de Usuarios</h1>
  <form id="userForm">
    <label for="email">Email:</label>
    <input type="email" id="email" required><br>
    <label for="name">Nombre:</label>
    <input type="text" id="name" required><br>
    <label for="direccion">Dirección:</label>
    <input type="text" id="direccion" required><br>
    <label for="telefono">Teléfono:</label>
    <input type="text" id="telefono" required><br>
    <label for="edad">Edad:</label>
    <input type="number" id="edad" required><br>
    <button type="button" onclick="addUser()">Agregar Usuario</button>
    <button type="button" onclick="findByEmail()">Buscar por Email</button>
    <button type="button" onclick="deleteUser()">Eliminar Usuario</button>
    <button type="button" onclick="findAllUsers()">Mostrar Todos</button>
  </form>
  <div id="responseArea" class="response"></div>
  <div id="errorArea" class="error"></div>
  <script>
    async function addUser() {
      const responseArea = document.getElementById('responseArea');
      const errorArea = document.getElementById('errorArea');
      const userData = {
        email: document.getElementById('email').value,
        name: document.getElementById('name').value,
        direccion: document.getElementById('direccion').value,
        telefono: document.getElementById('telefono').value,
        edad: parseInt(document.getElementById('edad').value),
      };
      try {
        const response = await fetch('/usuario/add', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(userData)
        });
        const result = await response.json();
        responseArea.textContent = 'Usuario agregado: ' + JSON.stringify(result);
        errorArea.textContent = '';
      } catch (error) {
        errorArea.textContent = 'Error al agregar usuario: ' + error.message;
        responseArea.textContent = '';
      }
    }

    async function findByEmail() {
      const email = document.getElementById('email').value;
      const responseArea = document.getElementById('responseArea');
      const errorArea = document.getElementById('errorArea');
      try {
        const response = await fetch(`/usuario/findByEmail/${email}`);
        const result = await response.json();
        responseArea.textContent = 'Usuario encontrado: ' + JSON.stringify(result);
        errorArea.textContent = '';
      } catch (error) {
        errorArea.textContent = 'Error al buscar usuario: ' + error.message;
        responseArea.textContent = '';
      }
    }

    async function deleteUser() {
      const email = document.getElementById('email').value; // Usamos el email para identificar al usuario a eliminar
      const responseArea = document.getElementById('responseArea');
      const errorArea = document.getElementById('errorArea');
      try {
        const response = await fetch(`/usuario/delete/${email}`, { method: 'DELETE' });
        const result = await response.json();
        responseArea.textContent = 'Usuario eliminado: ' + JSON.stringify(result);
        errorArea.textContent = '';
      } catch (error) {
        errorArea.textContent = 'Error al eliminar usuario: ' + error.message;
        responseArea.textContent = '';
      }
    }

    async function findAllUsers() {
      const responseArea = document.getElementById('responseArea');
      const errorArea = document.getElementById('errorArea');
      try {
        const response = await fetch('/usuario/findAll');
        const result = await response.json();
        responseArea.textContent = 'Usuarios encontrados: ' + JSON.stringify(result);
        errorArea.textContent = '';
      } catch (error) {
        errorArea.textContent = 'Error al buscar usuarios: ' + error.message;
        responseArea.textContent = '';
      }
    }
  </script>
</body>

</html>